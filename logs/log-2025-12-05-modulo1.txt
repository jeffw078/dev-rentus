2025-12-05 22:51:22 [INFO] Salvando OPS.xlsx em /uploads...
2025-12-05 22:51:22 [INFO] Salvando demitidos.xls em /uploads...
2025-12-05 22:51:22 [INFO] Salvando AVISO_PREVIO.xls em /uploads...
2025-12-05 22:51:22 [INFO] Salvando hk_avulso.xls em /uploads...
2025-12-05 22:51:22 [INFO] Salvando fp.xlsx em /uploads...
2025-12-05 22:51:22 [INFO] Salvando situacao.xlsx em /uploads...
2025-12-05 22:51:22 [INFO] Iniciando processamento do Módulo VR – VA – CESTA...
2025-12-05 22:51:22 [INFO] [INFO] Lendo OPS.xlsx...
2025-12-05 22:51:23 [INFO] [OK] Base OPS consolidada com 18 registros.
2025-12-05 22:51:23 [INFO] [INFO] Lendo demitidos.xls...
2025-12-05 22:51:23 [ERROR] Erro inesperado: Missing optional dependency 'xlrd'. Install xlrd >= 2.0.1 for xls Excel support Use pip or conda to install xlrd.
2025-12-05 22:51:23 Traceback (most recent call last):
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\compat\_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\importlib\__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1324, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'xlrd'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Jefferson\Desktop\Rentus\RENTUS ANALYZER\app\main.py", line 117, in modulo1_process
    output_path, mod_logs = process_modulo1(
                            ^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\Desktop\Rentus\RENTUS ANALYZER\projects\modulo1\Modulo1.py", line 72, in process_modulo1
    dem = pd.read_excel(demitidos_path)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 495, in read_excel
    io = ExcelFile(
         ^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\excel\_xlrd.py", line 45, in __init__
    import_optional_dependency("xlrd", extra=err_msg)
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\compat\_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'xlrd'. Install xlrd >= 2.0.1 for xls Excel support Use pip or conda to install xlrd.

2025-12-05 23:04:55 [INFO] Salvando OPS.xlsx em /uploads...
2025-12-05 23:04:55 [INFO] Salvando demitidos.xls em /uploads...
2025-12-05 23:04:55 [INFO] Salvando AVISO_PREVIO.xls em /uploads...
2025-12-05 23:04:55 [INFO] Salvando hk_avulso.xls em /uploads...
2025-12-05 23:04:55 [INFO] Salvando fp.xlsx em /uploads...
2025-12-05 23:04:55 [INFO] Salvando situacao.xlsx em /uploads...
2025-12-05 23:04:55 [INFO] Iniciando processamento do Módulo VR – VA – CESTA...
2025-12-05 23:04:55 [INFO] [INFO] Iniciando processamento interno do Módulo 1...
2025-12-05 23:04:55 [INFO] [INFO] Etapa 1 - Leitura dos arquivos
2025-12-05 23:04:55 [INFO] [INFO] Tentando abrir arquivo: OPS.xlsx
2025-12-05 23:04:55 [INFO] [OK] Arquivo OPS.xlsx carregado com 18 linhas.
2025-12-05 23:04:55 [INFO] [INFO] Tentando abrir arquivo: demitidos.xls
2025-12-05 23:04:55 [INFO] [OK] Arquivo demitidos.xls carregado com 6747 linhas.
2025-12-05 23:04:55 [INFO] [INFO] Tentando abrir arquivo: AVISO_PREVIO.xls
2025-12-05 23:04:55 [INFO] [OK] Arquivo AVISO_PREVIO.xls carregado com 30 linhas.
2025-12-05 23:04:55 [INFO] [INFO] Tentando abrir arquivo: hk_avulso.xls
2025-12-05 23:04:55 [INFO] [OK] Arquivo hk_avulso.xls carregado com 155 linhas.
2025-12-05 23:04:55 [INFO] [INFO] Tentando abrir arquivo: fp.xlsx
2025-12-05 23:05:04 [INFO] [OK] Arquivo fp.xlsx carregado com 593 linhas.
2025-12-05 23:05:04 [INFO] [INFO] Tentando abrir arquivo: situacao.xlsx
2025-12-05 23:05:04 [INFO] [ERROR] Falhou ao ler situacao.xlsx: File is not a zip file
2025-12-05 23:05:04 [ERROR] Erro inesperado: File is not a zip file
2025-12-05 23:05:04 Traceback (most recent call last):
  File "C:\Users\Jefferson\Desktop\Rentus\RENTUS ANALYZER\app\main.py", line 117, in modulo1_process
    output_path, mod_logs = process_modulo1(
                            ^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\Desktop\Rentus\RENTUS ANALYZER\projects\modulo1\Modulo1.py", line 91, in process_modulo1
    sit = read_excel_safely(situacao_path, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\Desktop\Rentus\RENTUS ANALYZER\projects\modulo1\Modulo1.py", line 28, in read_excel_safely
    sheet = p.get_sheet(file_name=str(path))
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pyexcel\core.py", line 41, in get_sheet
    named_content = sources.get_sheet_stream(**keywords)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pyexcel\internal\core.py", line 24, in get_sheet_stream
    sheets = a_source.get_data()
             ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pyexcel\plugins\sources\file_input.py", line 40, in get_data
    sheets = self.__parser.parse_file(self.__file_name, **self._keywords)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pyexcel\plugins\parsers\excel.py", line 20, in parse_file
    return self._parse_any(file_name, **keywords)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pyexcel\plugins\parsers\excel.py", line 51, in _parse_any
    sheets = get_data(anything, file_type=file_type, **keywords)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pyexcel_io\io.py", line 86, in get_data
    data, _ = _get_data(
              ^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pyexcel_io\io.py", line 105, in _get_data
    return load_data(**keywords)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pyexcel_io\io.py", line 191, in load_data
    reader.open(file_name, **keywords)
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pyexcel_io\reader.py", line 47, in open
    self.reader = self.reader_class(
                  ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pyexcel_xlsx\xlsxr.py", line 144, in __init__
    self._load_the_excel_file(file_alike_object)
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\pyexcel_xlsx\xlsxr.py", line 165, in _load_the_excel_file
    self.xlsx_book = openpyxl.load_workbook(
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\openpyxl\reader\excel.py", line 346, in load_workbook
    reader = ExcelReader(filename, read_only, keep_vba,
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\openpyxl\reader\excel.py", line 123, in __init__
    self.archive = _validate_archive(fn)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\site-packages\openpyxl\reader\excel.py", line 95, in _validate_archive
    archive = ZipFile(filename, 'r')
              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\zipfile\__init__.py", line 1349, in __init__
    self._RealGetContents()
  File "C:\Users\Jefferson\AppData\Local\Programs\Python\Python312\Lib\zipfile\__init__.py", line 1416, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

